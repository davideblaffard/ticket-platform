<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
    xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<body>
<div th:fragment="ticketNote(ticket, note)">
    <h3>Note del ticket</h3>

    <ul>
        <li th:each="n : ${ticket.notes}">
            <strong th:text="${n.operator.username}">Autore</strong> -
            <em th:text="${n.createdOn}">Data</em><br/>
            <span th:text="${n.content}">Contenuto</span>
            <hr/>
        </li>
    </ul>

    <!-- Form per aggiungere una nuova nota (solo operatori) -->
    <div sec:authorize="hasRole('OPERATOR')">
        <form th:action="@{'/operator/tickets/' + ${ticket.id} + '/notes'}" method="post" th:object="${note}">
            <div>
                <label for="content">Aggiungi nota:</label><br>
                <textarea th:field="*{content}" rows="4" cols="50" required></textarea>
            </div>
            <br>
            <button type="submit">Salva nota</button>
        </form>
    </div>
</div>
</body>
</html>
